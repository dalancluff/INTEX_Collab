<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Events | Ella Rises</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Nunito+Sans:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --clr-peach-light:#F9F5EA; --clr-pink-soft:#FFD8D1; --clr-pink:#F9AFB1; --clr-pink-dark:#CE325B;
      --clr-sage:#9AB59D; --clr-charcoal:#3A3F3B; --clr-coral:#F4B092; --clr-blue-muted:#99B7C6;
      --clr-purple:#978EC4; --clr-white:#fff; --clr-gray-light:#f5f5f5;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:'Nunito Sans',sans-serif;background:var(--clr-gray-light);color:var(--clr-charcoal);min-height:100vh}

    /* Navbar */
    .navbar{background:var(--clr-white);padding:1rem 2rem;box-shadow:0 2px 10px rgba(0,0,0,.1);display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10}
    .logo{font-family:'Montserrat',sans-serif;font-size:1.5rem;font-weight:700;color:var(--clr-pink-dark);text-decoration:none}
    .nav-links{list-style:none;display:flex;gap:1.5rem}
    .nav-links a{text-decoration:none;color:var(--clr-charcoal);font-weight:600}
    .nav-links a:hover{color:var(--clr-pink-dark)}

    /* Header */
    .page-header{max-width:1000px;margin:3rem auto 2rem;background:linear-gradient(135deg,var(--clr-pink-soft) 0%,var(--clr-peach-light) 100%);
      padding:2.5rem 1.5rem;border-radius:20px;box-shadow:0 4px 15px rgba(0,0,0,.08);text-align:center}
    .page-header h1{font-family:'Montserrat',sans-serif;font-size:2.4rem;color:var(--clr-pink-dark);margin-bottom:.6rem}
    .page-header p{font-size:1.1rem;opacity:.9}

    /* Filters */
    .filters{max-width:1000px;margin:0 auto 1rem;display:flex;gap:.75rem;align-items:center;justify-content:space-between;flex-wrap:wrap}
    .filters form{display:flex;gap:.75rem;align-items:center;flex-wrap:wrap}
    .input, .select{padding:.65rem .9rem;border-radius:10px;border:1px solid #e0e0e0;background:#fff;min-width:240px}
    .btn{background:var(--clr-pink-dark);color:#fff;border:none;border-radius:999px;padding:.7rem 1.2rem;font-weight:700;cursor:pointer}
    .btn:hover{background:#b72b51}

    /* Table */
    .table-wrap{max-width:1100px;margin:1.5rem auto 3rem;background:linear-gradient(135deg,var(--clr-peach-light) 0%,var(--clr-white) 100%);
      border-radius:20px;box-shadow:0 4px 20px rgba(0,0,0,.08);padding:2rem;overflow-x:auto}
    table{width:100%;border-collapse:collapse}
    thead{background:var(--clr-pink);color:var(--clr-charcoal)}
    th,td{padding:1rem;text-align:left;border-bottom:1px solid rgba(0,0,0,.05)}
    th{font-family:'Montserrat',sans-serif;font-weight:600}
    tr:hover{background:var(--clr-pink-soft);transition:background .3s}

    .badge{display:inline-block;padding:.25rem .6rem;border-radius:999px;font-size:.8rem;font-weight:700}
    .badge.STEM{background:var(--clr-sage);color:#fff}
    .badge.Arts{background:var(--clr-pink-dark);color:#fff}
    .badge.Both{background:var(--clr-blue-muted);color:#fff}

    @media (max-width:768px){
      .page-header h1{font-size:1.9rem}
      .table-wrap{padding:1rem}
      th,td{padding:.8rem}
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <a href="/" class="logo">Ella Rises</a>
    <ul class="nav-links">
      <li><a href="/dashboard">Dashboard</a></li>
      <li><a href="/participants">Participants</a></li>
      <li><a href="/events" style="color: var(--clr-pink-dark);">Events</a></li>
      <li><a href="/donations">Donations</a></li>
      <li><a href="/logout">Logout</a></li>
    </ul>
  </nav>

  <!-- Header -->
  <section class="page-header">
    <h1>Events</h1>
    <% if (user && user.role === 'manager') { %>
      <p>Browse and manage all upcoming events.</p>
    <% } else { %>
      <p>Browse upcoming events in your area.</p>
    <% } %>
  </section>

  <!-- Filters -->
  <div class="filters">
    <form method="get" action="/events">
      <input class="input" type="text" name="search" placeholder="Search title, description, location..." value="<%= (filters && filters.search) || '' %>">
      <select class="select" name="category">
        <option value="All" <%= (filters && filters.category === 'All') ? 'selected' : '' %>>All categories</option>
        <option value="STEM" <%= (filters && filters.category === 'STEM') ? 'selected' : '' %>>STEM</option>
        <option value="Arts" <%= (filters && filters.category === 'Arts') ? 'selected' : '' %>>Arts</option>
        <option value="Both" <%= (filters && filters.category === 'Both') ? 'selected' : '' %>>Both</option>
      </select>
      <button class="btn" type="submit">Apply</button>
    </form>

    <% if (user && user.role === 'manager') { %>
      <!-- Manager-only button (optional for future CRUD) -->
      <!-- <a href="/events/add" class="btn">Add New Event</a> -->
    <% } %>
  </div>

  <!-- Events Table -->
  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>When</th>
          <th>Title</th>
          <th>Category</th>
          <th>Location</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <% if (events && events.length) { %>
          <% events.forEach(e => { %>
            <tr>
              <td>
                <strong><%= new Date(e.start_at).toLocaleString() %></strong>
                <% if (e.end_at) { %>
                  <div style="opacity:.8;font-size:.9rem;">– <%= new Date(e.end_at).toLocaleString() %></div>
                <% } %>
              </td>
              <td><%= e.title %></td>
              <td><span class="badge <%= e.category || '' %>"><%= e.category || '—' %></span></td>
              <td>
                <%= e.location_name || '' %>
                <div style="opacity:.8;font-size:.9rem;">
                  <%= [e.location_city, e.location_state].filter(Boolean).join(', ') %>
                </div>
              </td>
              <td style="max-width:440px;"><%= e.description || '' %></td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr><td colspan="5" style="text-align:center;">No events found.</td></tr>
        <% } %>
      </tbody>
    </table>
  </div>

  <div style="text-align:center;margin-bottom:3rem;">
    <a class="btn" href="/dashboard">← Back to Dashboard</a>
  </div>
</body>
</html>